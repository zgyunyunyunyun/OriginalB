# 微信/抖音小游戏真机前检查清单（MVP）

适用项目：`OriginalB`（Unity 2022.3.62f2c1）

## 1. 构建前环境检查

- [ ] Unity 版本与项目一致：`2022.3.62f2c1`
- [ ] 目标场景只包含：`Assets/Scenes/MainScene.unity`
- [ ] 无新增原生插件（`*.dll / *.aar / *.so`）
- [ ] Console 无编译错误（Error=0）

## 2. 平台宏与服务注册检查

### 微信包

- [ ] Scripting Define Symbols 含：`PLATFORM_WECHAT`
- [ ] 不包含：`PLATFORM_DOUYIN`

### 抖音包

- [ ] Scripting Define Symbols 含：`PLATFORM_DOUYIN`
- [ ] 不包含：`PLATFORM_WECHAT`

### 启动日志必须出现（通过 PlatformDiagnostics）

- [ ] `PlatformContext=WeChatPlatformContext`（微信）或 `PlatformContext=DouyinPlatformContext`（抖音）
- [ ] `InputService=WeChatInputService` / `DouyinInputService`
- [ ] `LogService=WeChatLogService` / `DouyinLogService`
- [ ] `StorageService=WeChatStorageService` / `DouyinStorageService`
- [ ] `AuthService=WeChatAuthService` / `DouyinAuthService`
- [ ] `AdService=WeChatAdService` / `DouyinAdService`
- [ ] `ShareService=WeChatShareService` / `DouyinShareService`
- [ ] `AnalyticsService=WeChatAnalyticsService` / `DouyinAnalyticsService`

## 3. 交互与玩法最小验收（真机）

- [ ] 点击箱子可抬起摇摆
- [ ] 拖拽箱子跟手移动，无明显跳点
- [ ] 松手可正确落到合法货架
- [ ] 不合法落位会回弹
- [ ] 三消后状态刷新正确
- [ ] 通关后积分发放正常

## 4. 存储一致性验收

- [ ] 每日次数在同一天内递减，次日自动重置
- [ ] 累计积分跨重启可保留
- [ ] 关闭并重启小游戏后，关键数据不丢失

## 5. 日志与稳定性检查

- [ ] 小游戏端无文件写入异常日志（已应自动降级）
- [ ] 连续操作 10 分钟无崩溃
- [ ] 无持续增长型严重告警

## 6. 性能与包体（MVP最低要求）

- [ ] 首次进入主场景可接受（团队自定义阈值）
- [ ] 交互期间帧率稳定（建议目标 >= 30 FPS）
- [ ] 内存无明显持续上升
- [ ] 首包大小符合平台审核要求

## 7. 阻塞发布项（任一命中即不可提审）

- [ ] 平台上下文注册错误（微信包跑出 Douyin 或 Common）
- [ ] 关键交互失败（拖拽/点击/落位）
- [ ] 数据持久化异常（次数/积分）
- [ ] 运行崩溃或黑屏

## 8. 推荐执行顺序

1. Editor 中运行并看启动诊断日志
2. 分别构建微信包、抖音包
3. 各自真机跑第 3~5 节用例
4. 记录差异并修复
5. 回归通过后再提审

## 9. 快速排错建议

- 平台注册不对：先检查宏定义，再看 `PlatformBootstrap` 是否被裁剪或未执行。
- 输入异常：先看启动日志中的 `InputService`，再看触摸事件是否进入。
- 存储异常：检查 `StorageService` 是否为目标平台实现，确认是否有 Save 调用路径。

## 10. 当前阶段说明（重要）

- 本阶段已完成双端服务骨架与注册分发，但暂未导入微信/抖音官方 SDK。
- `Auth/Ad/Share/Analytics` 当前为占位实现，用于提前固化接口与调用链。
- 后续导入 SDK 时，只需在 `Platform/Services/WeChat` 与 `Platform/Services/Douyin` 对应实现中替换逻辑。
- 广告奖励货架已预留业务入口：`GameManager.TryUseAdRewardShelfWithAd(Action<bool>)`。
- 建议统一调用入口：`GameManager.RequestAdRewardShelf(Action<bool>, AdRewardShelfPolicy)`（优先广告，策略枚举更清晰）。
- 最小回归用例表：`Docs/小游戏最小回归用例表.md`。
- 按小时执行计划：`Docs/双端小游戏MVP执行计划.md`。
- MVP体验报告模板：`Docs/小游戏MVP体验报告模板.md`。
