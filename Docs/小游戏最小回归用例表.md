# 微信/抖音小游戏最小回归用例表（SDK接入前后通用）

## A. 启动与平台注册

| 用例ID | 步骤 | 预期结果 |
| --- | --- | --- |
| REG-001 | 进入 Play，观察启动日志 | 出现 PlatformDiagnostics 报告 |
| REG-002 | 微信宏构建后启动 | `PlatformContext=WeChatPlatformContext` |
| REG-003 | 抖音宏构建后启动 | `PlatformContext=DouyinPlatformContext` |
| REG-004 | 检查服务类型 | Input/Log/Storage/Auth/Ad/Share/Analytics 均已注册 |

## B. 交互与核心玩法

| 用例ID | 步骤 | 预期结果 |
| --- | --- | --- |
| REG-101 | 点击箱子 | 箱子抬起并摇摆 |
| REG-102 | 拖拽箱子至合法货架 | 松手后成功落位 |
| REG-103 | 拖拽箱子至非法位置 | 箱子回弹到原位 |
| REG-104 | 连续同色达到三消 | 正确消除且分数增长 |
| REG-105 | 找到小猫达成通关 | 状态变为 Win，奖励结算 |

## C. 存储一致性

| 用例ID | 步骤 | 预期结果 |
| --- | --- | --- |
| REG-201 | 当日多次开局 | 每日次数递减 |
| REG-202 | 修改系统到次日再启动 | 每日次数重置 |
| REG-203 | 通关后重启应用 | 累计积分保留 |

## D. 广告奖励货架（当前阶段）

| 用例ID | 步骤 | 预期结果 |
| --- | --- | --- |
| REG-301 | 调用 `RequestAdRewardShelf(cb, AdRewardShelfPolicy.RequireAdReady)` 且广告未就绪 | 回调 false，记录 `ad_reward_shelf_not_ready` |
| REG-302 | 调用 `RequestAdRewardShelf(cb, AdRewardShelfPolicy.AllowFallbackWithoutAd)` 且广告未就绪 | 回退发放货架（若剩余次数>0），记录 `ad_reward_shelf_fallback` |
| REG-303 | 调用 `TryUseAdRewardShelfWithAd(cb)` 且广告成功 | 发放货架，记录 `ad_reward_shelf_granted` |
| REG-304 | 调用 `TryUseAdRewardShelfWithAd(cb)` 且广告失败 | 回调 false，记录 `ad_reward_shelf_failed` |

## E. 阻塞条件

- 启动日志中平台上下文与宏不一致。
- 关键交互不可用（点击/拖拽/落位）。
- 数据不持久（次数或积分丢失）。
- 广告奖励流程与配置不一致（需要广告却被无条件发放，或反之）。
